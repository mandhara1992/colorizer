# colorizer
A supervised learning project written in Python to colorize black and white images.
This project involves two components namely feature extraction and coding and training the neural network. 
Images in computers are represented in the 3 channel RGB color space, in which the color of each pixel is determined by a 3-tuple ρ = (r, g, b) denoting the red, green, and blue components of that color respectively. In my approach, I choose to represent images in the LAB color model. The L-component is a single channel 2D array with values between 0-100 representing the lightness or the intensity of each pixel, A is the red-green component with values between -127 to +128 (shifted to 0-255) and B is the yellow-blue component whose values range from -127 to +128 (shifted to 0-255).
I am using a 7x7 patch of pixels and so, my input layer has 49 neurons. I am using one hidden layer with 30 neurons and an output layers with 16 neurons corresponding to the 16 clusters have generated based on the values of A and B components.  
Initially, I am forming 16 clusters based on pixel values, mainly A-component and B-component values of the images. Every cluster mean represents a set of a A and a B values.  For every input image, I classify all the pixels of the image into one of those 16 clusters. Now, the input to the neural network is a b/w image and the neural network tries to predict the class in which that particular pixel belongs. The 16 output neurons give the activation values for each of the 16 classes and the neuron having the maximum activation is the class the pixel is considered to be in. This is the predicted output. Since I have calculated the actual cluster or class where that pixel belongs to, I can calculate the error (prediction - target) where both prediction and target are 16x1 vectors, prediction vector being activations of the 16 output neurons and the target vector being 1 for the actual cluster number and 0’s otherwise. This error is calculated at the output layer and then back propagated to the other layers in the network. So, the error that I am calculating is the misclassification of the pixel to a particular cluster. Perceptually, the network tries to correctly classify each pixel to its corresponding cluster and the cluster centroid gives us the A and B values which combined with the input gives us the RGB coloured image. I am mapping the L components to the A and B components of colour images and training the model. The model begins to learn the corresponding values of RGB components for a specific lightness/intensity that belongs to a patch of pixels. I am using a patch of 7x7 pixels and determining the mapping between the lightness of the whole patch and the values of A and B components of the pixel at the centre of this patch. I am training the model on multiple such patches across the whole image. I have implemented a feed forward and backward propagation algorithm to train the neural network where the error back propagated is explained above. I have used the sigmoid activation function along with uniform random (between 0 and 1) initialization of the initial weights and biases and are performing gradient descent to converge to the optimum.
